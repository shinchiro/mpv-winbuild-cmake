From 17ecaa6d5699e1c26aae96f224d63125c7cf08cf Mon Sep 17 00:00:00 2001
From: shinchiro <shinchiro@users.noreply.github.com>
Date: Tue, 10 Jan 2023 13:38:39 +0800
Subject: [PATCH] Add .exe to binary name

---
 Makefile | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)

diff --git a/Makefile b/Makefile
index 8255463..3a09f1a 100644
--- a/Makefile
+++ b/Makefile
@@ -2,7 +2,7 @@
 #
 # Useful targets are: release, install, uninstall.
 
-default: build/debug/mujs build/debug/mujs-pp
+default: build/release/mujs build/release/mujs-pp
 
 CFLAGS = -std=c99 -pedantic -Wall -Wextra -Wno-unused-parameter
 
@@ -29,6 +29,10 @@ ifeq ($(shell uname),FreeBSD)
   CFLAGS += -I/usr/local/include -L/usr/local/lib
 endif
 
+ifeq "$(host)" "mingw"
+  EXT := .exe
+endif
+
 HDRS = mujs.h jsi.h regexp.h utf.h astnames.h opnames.h
 
 SRCS = \
@@ -99,7 +103,7 @@ build/release/libmujs.o: one.c $(SRCS) $(HDRS)
 build/release/libmujs.a: build/release/libmujs.o
 	$(AR) cr $@ $^
 build/release/mujs: main.c build/release/libmujs.o
-	$(CC) $(CFLAGS) $(OPTIM) -o $@ $^ -lm -DHAVE_READLINE -lreadline
+	$(CC) $(CFLAGS) $(OPTIM) -o $@ $^ -lm
 build/release/mujs-pp: pp.c build/release/libmujs.o
 	$(CC) $(CFLAGS) $(OPTIM) -o $@ $^ -lm
 
@@ -119,7 +123,7 @@ install: build/release/mujs build/release/libmujs.a build/release/libmujs.$(SO)
 	install -d $(DESTDIR)$(bindir)
 	install -m 644 mujs.h $(DESTDIR)$(incdir)
 	install -m 644 build/release/mujs.pc $(DESTDIR)$(libdir)/pkgconfig
-	install -m 755 build/release/mujs $(DESTDIR)$(bindir)
+	install -m 755 build/release/mujs$(EXT) $(DESTDIR)$(bindir)
 	install -m 644 build/release/libmujs.a $(DESTDIR)$(libdir)
 	install -m 755 build/release/libmujs.$(SO) $(DESTDIR)$(libdir)
 
-- 
2.39.0


